<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE sqlMap       
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"       
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<!-- namespace : 주로 테이블 명 사용, 생략 가능 -->
<sqlMap namespace="sol_admin">
  <!-- 매개변수 NoticeDTO 사용 -->
  <typeAlias alias="PlayerDTO" type="kr.co.solproject.player.PlayerDTO" />
  <typeAlias alias="CategoryDTO" type="kr.co.solproject.category.CategoryDTO" />
  <typeAlias alias="MemberDTO" type="kr.co.solproject.member.MemberDTO" />
  
  <select id="getCategoryno" parameterClass="Map" resultClass="PlayerDTO">
  		select categoryno
  		from sol_category
  		where gwamok = #gwamok# and grade = #grade#
   </select>
   
   <select id="getLecList1" resultClass="PlayerDTO">
		select lectureno,subject,filename,filesize,poster,teacher,lecturetime
		from sol_lecture
		order by lectureno DESC
    </select> 
	
	<select id="getLecTotal1" resultClass="Integer">
		select count(*) as cnt
		from sol_lecture
	</select>
 
	<select id="lecRead" parameterClass="Integer" resultClass="PlayerDTO">
		select subject,filename,filesize,poster,teacher,lecturetime,categoryno
		from sol_lecture
		where lectureno = #lectureno#
	</select>
	
	<select id="categoryRead" parameterClass="Integer" resultClass="CategoryDTO">
		select grade, gwamok
		from sol_category
		where categoryno = #categoryno#
	</select>
    
    <update id="categoryDelProc" parameterClass="Integer">
		delete from sol_category
		where categoryno = #categoryno#
	</update>
	
	<update id="lecDelProc" parameterClass="Integer">
		delete from sol_lecture
		where lectureno = #lectureno#
	</update>
	
	<update id="lecUpdate" parameterClass="PlayerDTO">
		update sol_lecture
		set subject = #subject#, filename=#filename#, filesize=#filesize#, poster=#poster#,teacher=#teacher#,lecturetime=#lecturetime#
		where lectureno = #lectureno#
	</update>
	
	<select id="getLecList" parameterClass="Map" resultClass="PlayerDTO">
		SELECT lecture.lectureno,lecture.subject,lecture.filename,lecture.filesize,lecture.poster,lecture.teacher,lecture.lecturetime
		FROM sol_lecture lecture join sol_category category
		ON lecture.categoryno = category.categoryno
		WHERE category.grade = #grade# AND category.gwamok = #gwamok#
		ORDER BY lecture.lectureno DESC
	</select>
	
	<select id="getMemList" parameterClass="Map" resultClass="MemberDTO">
		SELECT id, name, email, tel, mdate, mlevel, promise
		FROM sol_member
		<isNotEmpty prepend="" property="col"> 
			order by #col# asc
		</isNotEmpty>
		limit #sno#, #numPerPage#
	</select>
	
	<select id="getMemTotal" resultClass="Integer">
		select count(*) as cnt
		from sol_member
	</select>
	
	<update id="memLevelProc" parameterClass="Map">
		update sol_member
		set mlevel =#mlevel#
		where id = #id#
	</update>
	
	<update id="memDelProc" parameterClass="Map">
		delete from sol_member
		where id 
		<iterate prepend="IN" property="list" open="(" close=")"
			conjunction=",">
			#list[]#
		</iterate>
	</update>
  
</sqlMap>