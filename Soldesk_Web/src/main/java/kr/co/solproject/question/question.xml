<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="sol_question"><!-- 테이블이름 -->
	<typeAlias alias="QuestionDTO" type="kr.co.solproject.question.QuestionDTO" />

	<update id="insert" parameterClass="QuestionDTO">
		
		insert into sol_question(testno, questno, qtitle, qtype, answer, comment, poster, example)
		values(#testno#,(select ifnull(max(questno),0)+1 from sol_question as SQ where testno=#testno#),#qtitle#,#qtype#,#answer#,#comment#,#poster#,#example#)
		
	</update>

	<select id="list" resultClass="QuestionDTO" parameterClass="Map">
		select testno, questno, qtitle, qtype, answer, comment, poster, qynshow, example
		from sol_question
		
		<dynamic prepend="WHERE">
			<isNotEmpty property="col">
				qtype = #col# and testno = #testno#
			</isNotEmpty>
			<isEmpty property="col">
				testno = #testno#
			</isEmpty>			
		</dynamic>
		
		order by questno asc
	</select>

	<select id="total" resultClass="Integer" parameterClass="Map">
		select count(*) as cnt
		from sol_question
		<dynamic prepend="WHERE">
			<isNotEmpty property="col">
				qtype = #col# and testno = #testno#
			</isNotEmpty>
			<isEmpty property="col">
				testno = #testno#
			</isEmpty>			
		</dynamic>
	</select>

</sqlMap>